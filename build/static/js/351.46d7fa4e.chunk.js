"use strict";(self.webpackChunktochly=self.webpackChunktochly||[]).push([[351],{8849:(e,s,a)=>{a.d(s,{s:()=>t});var i=a(7313),l=a(3814);const t=()=>(0,i.useContext)(l.J)},489:(e,s,a)=>{a.r(s),a.d(s,{default:()=>Ce});var i=a(7313),l=a(8467),t=a(6254),n=a(8437),c=a(6678),r=a(9686),d=a(4861),m=a(1878),o=a(9120),h=a(6047),x=a(238),u=a(454),j=a(9569),p=a(5590),g=a(6417);const N=function(e){const[s,a]=(0,i.useState)(!1),[l,t]=(0,i.useState)(!0),[n,c]=(0,i.useState)(!1),[r]=(0,i.useState)([{name:"Admin-A.zip",size:"12.5 MB",thumbnail:"ri-file-text-fill"},{name:"Image-1.jpg",size:"4.2 MB",thumbnail:"ri-image-fill"},{name:"Image-2.jpg",size:"3.1 MB",thumbnail:"ri-image-fill"},{name:"Landing-A.zip",size:"6.7 MB",thumbnail:"ri-file-text-fill"}]),{t:N}=(0,p.$G)();return(0,g.jsx)(i.Fragment,{children:(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"px-4 pt-4",children:[(0,g.jsx)("div",{className:"user-chat-nav float-end",children:(0,g.jsxs)(d.Z,{isOpen:s,toggle:()=>a(!s),children:[(0,g.jsx)(m.Z,{tag:"a",className:"font-size-18 text-muted dropdown-toggle",children:(0,g.jsx)("i",{className:"ri-more-2-fill"})}),(0,g.jsxs)(o.Z,{className:"dropdown-menu-end",children:[(0,g.jsx)(h.Z,{children:N("Edit")}),(0,g.jsx)(h.Z,{children:N("Action")}),(0,g.jsx)(h.Z,{divider:!0}),(0,g.jsx)(h.Z,{children:N("Another action")})]})]})}),(0,g.jsx)("h4",{className:"mb-0",children:N("My Profile")})]}),(0,g.jsxs)("div",{className:"text-center p-4 border-bottom",children:[(0,g.jsx)("div",{className:"mb-4",children:(0,g.jsx)("img",{src:j,className:"rounded-circle avatar-lg img-thumbnail",alt:"chatvia"})}),(0,g.jsx)("h5",{className:"font-size-16 mb-1 text-truncate",children:N("Patricia Smith")}),(0,g.jsxs)("p",{className:"text-muted text-truncate mb-1",children:[(0,g.jsx)("i",{className:"ri-record-circle-fill font-size-10 text-success me-1 d-inline-block"})," ",N("Active")]})]}),(0,g.jsxs)("div",{className:"p-4 user-profile-desc",children:[(0,g.jsx)("div",{className:"text-muted",children:(0,g.jsx)("p",{className:"mb-4",children:N("If several languages coalesce, the grammar of the resulting language is more simple and regular than that of the individual.")})}),(0,g.jsxs)("div",{id:"profile-user-accordion-1",className:"custom-accordion",children:[(0,g.jsx)(x.Z,{className:"shadow-none border mb-2",children:(0,g.jsxs)(u.zd,{title:"About",iconClass:"ri-user-2-line",isOpen:l,toggleCollapse:()=>{t(!l),c(!1)},children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-muted mb-1",children:N("Name")}),(0,g.jsx)("h5",{className:"font-size-14",children:N("Patricia Smith")})]}),(0,g.jsxs)("div",{className:"mt-4",children:[(0,g.jsx)("p",{className:"text-muted mb-1",children:N("Email")}),(0,g.jsx)("h5",{className:"font-size-14",children:N("adc@123.com")})]}),(0,g.jsxs)("div",{className:"mt-4",children:[(0,g.jsx)("p",{className:"text-muted mb-1",children:N("Time")}),(0,g.jsx)("h5",{className:"font-size-14",children:N("11:40 AM")})]}),(0,g.jsxs)("div",{className:"mt-4",children:[(0,g.jsx)("p",{className:"text-muted mb-1",children:N("Location")}),(0,g.jsx)("h5",{className:"font-size-14 mb-0",children:N("California, USA")})]})]})}),(0,g.jsx)(x.Z,{className:"mb-1 shadow-none border",children:(0,g.jsx)(u.zd,{title:"Attached Files",iconClass:"ri-attachment-line",isOpen:n,toggleCollapse:()=>{c(!n),t(!1)},children:(0,g.jsx)(u.We,{files:r})})})]})]})]})})};var v=a(1413),f=a(8140),b=a(1781),y=a(2135),Z=a(1155),C=a(4667),S=a(2169);const w=a(8880).e.injectEndpoints({endpoints:e=>({getChatRooms:e.query({query:e=>{let{tid:s,userId:a,search:i}=e;return"/chats/rooms?team_id=".concat(s,"&user_id=").concat(a,"&search=").concat(i)},providesTags:["ChatRoom"]}),getRoomChatMessages:e.query({query:e=>{let{room_id:s,userId:a,search:i}=e;return"/chats/rooms/".concat(s,"/messages?user_id=").concat(a,"&search=").concat(i)},providesTags:["ChatMessage"]})})}),{useGetChatRoomsQuery:z}=w;var _=a(8849);function k(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;const[a,l]=(0,i.useState)(e);return(0,i.useEffect)((()=>{const a=setTimeout((()=>l(e)),s);return()=>clearTimeout(a)}),[e,s]),a}var M=a(3113),T=a(2963),A=a.n(T),E=(a(3289),a(8754));const I=e=>{let{setSearch:s,teamMembers:a=[]}=e;const i=(0,_.s)(),{tid:n}=(0,l.UO)(),c=e=>a=>{null!==i&&void 0!==i&&i.connected?((0,E.xm)(i,{team_id:n,receiver_id:String(e.user.id)}),s("")):t.Am.error("Could not establish connection with chat server")};return(0,g.jsx)("div",{className:"px-4 pb-4 dot_remove",dir:"ltr",children:(0,g.jsx)(A(),{responsive:{0:{items:2},576:{items:3},768:{items:4}},mouseTracking:!0,autoPlayInterval:3e3,disableDotsControls:!1,disableButtonsControls:!1,children:null===a||void 0===a?void 0:a.map((e=>(0,g.jsx)("div",{className:"item clickable",onClick:c(e),children:(0,g.jsxs)("div",{className:"user-status-box",children:[(0,g.jsxs)("div",{"aria-label":"status",className:"avatar-xs mx-auto d-block chat-user-img ".concat(e.online&&"online"," "),children:[(0,g.jsx)("span",{className:"avatar-title rounded-circle bg-primary-subtle text-primary",children:e.full_name.charAt(0)}),(0,g.jsx)("span",{className:"user-status"})]}),(0,g.jsx)("h5",{className:"font-size-10 text-truncate mt-3 mb-1",children:e.full_name})]})},e.id)))})})},O=()=>{const[e,s]=(0,i.useState)(""),[a,c]=(0,i.useState)({}),{activeChatRoom:r,setActiveChatRoom:d}=(0,i.useContext)(M.p),m=(0,_.s)(),{tid:o}=(0,l.UO)(),h=(0,n.T)(),x=k(e),{data:u}=(0,S.XC)(),[j,{data:p,isError:N}]=(0,C.E$)(),{data:T,isError:A}=z({tid:o,userId:null===u||void 0===u?void 0:u.id,search:x},{skip:!(null!==u&&void 0!==u&&u.id)}),E=(e,s)=>{e.preventDefault(),d(s),localStorage.setItem("lastActiveRoom",JSON.stringify(s))};return(0,i.useEffect)((()=>{N&&t.Am.error("Error fetching team members"),A&&t.Am.error("Error fetching chat rooms")}),[N,A]),(0,i.useEffect)((()=>{if(!T)return;const e=localStorage.getItem("lastActiveRoom"),s=e?JSON.parse(e):null,a=T.find((e=>e.room_id===(null===s||void 0===s?void 0:s.room_id))),i=null!==a&&void 0!==a?a:T[0];d(i),localStorage.setItem("lastActiveRoom",JSON.stringify(i))}),[T,d]),(0,i.useEffect)((()=>{j({tid:o,search:x},!0)}),[x,o]),(0,i.useEffect)((()=>{if(!m||null===u||void 0===u||!u.id)return;const e={tid:o,userId:u.id,search:x},s=s=>{const a=s.data;d(a),localStorage.setItem("lastActiveRoom",JSON.stringify(a)),h(w.util.updateQueryData("getChatRooms",e,(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.some((e=>e.room_id===a.room_id))||e.unshift(a)})))},a=e=>{c((s=>(0,v.Z)((0,v.Z)({},s),{},{[e]:!0}))),setTimeout((()=>{c((s=>{const a=(0,v.Z)({},s);return delete a[e],a}))}),3e3)};return m.on("chat_room",s),m.on("typing",a),()=>{m.off("chat_room",s),m.off("typing",a)}}),[m,null===u||void 0===u?void 0:u.id,x,o]),(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"px-4 pt-4",children:[(0,g.jsx)("h4",{className:"mb-4",children:"Chats"}),(0,g.jsx)("div",{className:"search-box chat-search-box",children:(0,g.jsxs)(f.Z,{className:"mb-3 rounded-3",children:[(0,g.jsx)("span",{className:"input-group-text text-muted bg-light pe-1 ps-3",id:"basic-addon1",children:(0,g.jsx)("i",{className:"ri-search-line search-icon font-size-18"})}),(0,g.jsx)(b.Z,{type:"text",value:e,onChange:e=>{var a;const i=null===(a=e.target)||void 0===a?void 0:a.value;s(i)},className:"form-control bg-light",placeholder:"Search members"})]})})]}),(0,g.jsx)(I,{teamMembers:p,setSearch:s}),(0,g.jsxs)("div",{children:[(0,g.jsx)("h5",{className:"mb-3 px-3 font-size-16",children:"Recent"}),(0,g.jsx)(Z.Z,{className:"chat-message-list",children:(0,g.jsx)("ul",{className:"list-unstyled chat-list chat-user-list px-2",id:"chat-list",children:null===T||void 0===T?void 0:T.map((e=>(0,g.jsx)("li",{className:"".concat(e.unread_messages_count?"unread":a[e.room_id]?"typing":e.room_id===(null===r||void 0===r?void 0:r.room_id)?"active":""),children:(0,g.jsx)(y.rU,{to:"#",onClick:s=>E(s,e),children:(0,g.jsxs)("div",{onClick:s=>E(s,e),className:"d-flex",children:[e.participant_profile_pic?(0,g.jsxs)("div",{className:"chat-user-img ".concat(e.is_participant_online&&"online"," align-self-center ms-0"),children:[(0,g.jsx)("img",{src:e.participant_profile_pic,className:"rounded-circle avatar-xs",alt:"chat-avatar"}),e.is_participant_online&&(0,g.jsx)("span",{className:"user-status"})]}):(0,g.jsxs)("div",{className:"chat-user-img ".concat(e.is_participant_online&&"online"," align-self-center ms-0"),children:[(0,g.jsx)("div",{className:"avatar-xs",children:(0,g.jsx)("span",{className:"avatar-title rounded-circle bg-primary-subtle text-primary",children:e.participant_name.charAt(0)})}),e.is_participant_online&&(0,g.jsx)("span",{className:"user-status"})]}),(0,g.jsxs)("div",{className:"flex-grow-1 overflow-hidden",children:[(0,g.jsx)("h5",{className:"text-truncate font-size-15 mb-1 ms-3",children:e.participant_name}),(0,g.jsx)("p",{className:"chat-user-message font-size-14 text-truncate mb-0 ms-3",children:a[e.room_id]?(0,g.jsxs)(g.Fragment,{children:["typing",(0,g.jsxs)("span",{className:"animate-typing",children:[(0,g.jsx)("span",{className:"dot ms-1"}),(0,g.jsx)("span",{className:"dot ms-1"}),(0,g.jsx)("span",{className:"dot ms-1"})]})]}):(0,g.jsxs)(g.Fragment,{children:["image"===e.last_message_type&&(0,g.jsx)("i",{className:"ri-image-fill align-middle me-1"}),"file"===e.last_message_type&&(0,g.jsx)("i",{className:"ri-file-text-fill align-middle me-1"}),e.last_message]})})]}),e.unread_messages_count>0&&(0,g.jsx)("div",{className:"unread-message",children:(0,g.jsx)("span",{className:"badge badge-soft-danger rounded-pill",children:e.unread_messages_count>=20?"".concat(e.unread_messages_count,"+"):e.unread_messages_count})})]})})},e.room_id)))})})]})]})};var F=a(9327),L=a(3256),P=a(6707),U=a(2020),R=a(8642),G=a(6597),D=a(4209),H=a(6806),q=a(8683),B=a(2527),$=a(3516),J=a(2181),Q=a(8732),V=a(5374);const W=()=>{const{t:e}=(0,p.$G)(),s=(0,n.T)(),a=(0,n.C)((e=>e.chat.groups)),[l,t]=(0,i.useState)(!1),[c,r]=(0,i.useState)(!1),[d,m]=(0,i.useState)([]),[o,h]=(0,i.useState)(!1),[j,N]=(0,i.useState)(""),[v,C]=(0,i.useState)(""),[S,w]=(0,i.useState)(""),z=()=>{t(!l)};return(0,g.jsx)(i.Fragment,{children:(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"p-4",children:[(0,g.jsxs)("div",{className:"user-chat-nav float-end",children:[(0,g.jsx)("div",{id:"create-group",children:(0,g.jsx)(F.Z,{onClick:z,type:"button",color:"link",className:"text-decoration-none text-muted font-size-18 py-0",children:(0,g.jsx)("i",{className:"ri-group-line me-1"})})}),(0,g.jsx)(L.Z,{target:"create-group",placement:"bottom",children:"Create group"})]}),(0,g.jsx)("h4",{className:"mb-4",children:e("Groups")}),(0,g.jsxs)(P.Z,{isOpen:l,centered:!0,toggle:z,children:[(0,g.jsx)(U.Z,{tag:"h5",className:"modal-title font-size-14",toggle:z,children:e("Create New Group")}),(0,g.jsx)(R.Z,{className:"p-4",children:(0,g.jsxs)(G.Z,{children:[(0,g.jsxs)("div",{className:"mb-4",children:[(0,g.jsx)(D.Z,{className:"form-label",htmlFor:"addgroupname-input",children:e("Group Name")}),(0,g.jsx)(b.Z,{type:"text",className:"form-control",id:"addgroupname-input",value:v,onChange:e=>C(e.target.value),placeholder:"Enter Group Name"})]}),(0,g.jsxs)("div",{className:"mb-4",children:[(0,g.jsx)(D.Z,{className:"form-label",children:e("Group Members")}),(0,g.jsx)(H.Z,{isOpen:o,color:"danger",children:j}),(0,g.jsx)("div",{className:"mb-3",children:(0,g.jsx)(F.Z,{color:"light",size:"sm",type:"button",onClick:()=>{r(!c)},children:e("Select Members")})}),(0,g.jsx)(q.Z,{isOpen:c,id:"groupmembercollapse",children:(0,g.jsxs)(x.Z,{className:"border",children:[(0,g.jsx)(B.Z,{children:(0,g.jsx)("h5",{className:"font-size-15 mb-0",children:e("Contacts")})}),(0,g.jsx)($.Z,{className:"p-2",children:(0,g.jsx)(Z.Z,{style:{maxHeight:"150px"},children:(0,g.jsx)("div",{id:"addContacts",children:(0,g.jsx)(u._o,{handleCheck:(e,s)=>{e.target.checked&&m((a=>[...a,{id:s,name:e.target.value}]))}})})})})]})})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)(D.Z,{className:"form-label",htmlFor:"addgroupdescription-input",children:e("Description")}),(0,g.jsx)("textarea",{className:"form-control",id:"addgroupdescription-input",value:S,onChange:e=>w(e.target.value),rows:3,placeholder:"Enter Description"})]})]})}),(0,g.jsxs)(J.Z,{children:[(0,g.jsx)(F.Z,{type:"button",color:"link",onClick:z,children:e("Close")}),(0,g.jsx)(F.Z,{type:"button",color:"primary",onClick:()=>{if(d.length>2){const e={groupId:a.length+1,name:"#".concat(v),profilePicture:"Null",isGroup:!0,unRead:0,isNew:!0,desc:S,members:d};s((0,V.sS)(e)),z()}else 1===d.length?(N("Minimum 2 members required!!!"),h(!0)):(N("Please Select Members!!!"),h(!0));setTimeout((()=>h(!1)),3e3)},children:"Create Group"})]})]}),(0,g.jsx)("div",{className:"search-box chat-search-box",children:(0,g.jsxs)(f.Z,{size:"lg",className:"bg-light rounded-lg",children:[(0,g.jsx)(F.Z,{color:"link",className:"text-decoration-none text-muted pr-1",type:"button",children:(0,g.jsx)("i",{className:"ri-search-line search-icon font-size-18"})}),(0,g.jsx)(b.Z,{type:"text",className:"form-control bg-light",placeholder:"Search groups..."})]})})]}),(0,g.jsx)(Z.Z,{style:{maxHeight:"100%"},className:"p-4 chat-message-list chat-group-list",children:(0,g.jsx)("ul",{className:"list-unstyled chat-list",children:a.map(((e,s)=>(0,g.jsx)("li",{children:(0,g.jsx)(y.rU,{to:"#",children:(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("div",{className:"chat-user-img me-3 ms-0",children:(0,g.jsx)("div",{className:"avatar-xs",children:(0,g.jsx)("span",{className:"avatar-title rounded-circle bg-primary-subtle text-primary",children:e.name.charAt(1)})})}),(0,g.jsx)("div",{className:"flex-grow-1 overflow-hidden",children:(0,g.jsxs)("h5",{className:"text-truncate font-size-14 mb-0",children:[e.name,0!==e.unRead&&(0,g.jsx)(Q.Z,{color:"none",pill:!0,className:"badge-soft-danger float-end",children:e.unRead>=20?"".concat(e.unRead,"+"):e.unRead}),e.isNew&&(0,g.jsx)(Q.Z,{color:"none",pill:!0,className:"badge-soft-danger float-end",children:"New"})]})})]})})},s)))})})]})})};var X=a(9834),Y=a(3503),K=a(1933),ee=a(5383);const se=()=>{const{t:e}=(0,p.$G)(),{tid:s}=(0,l.UO)(),[a,n]=(0,i.useState)(!1),{currentMember:c}=(0,i.useContext)(M.p),[r,{isLoading:d}]=(0,ee.DS)(),m=e=>{const a=localStorage.getItem("invitations");if(!a)return!0;const i=JSON.parse(a)[s];if(!i)return!0;const l=i[e];return!l||function(e){const s=new Date(e);return(new Date).getTime()-s.getTime()>=864e5}(l)},o=()=>{n((e=>!e))},h=(0,Y.TA)({initialValues:{email:"",role:""},validationSchema:K.Ry({email:K.Z_().required(e("Please Enter Your Email")),role:K.Z_().required(e("Enter membership role"))}),onSubmit:e=>{if(!m(e.email))return void t.Am.info("This user already has an open invitation.");const a="".concat("http://localhost:3000","/invitations/accept-invite");r({tid:s,inviteeEmail:e.email,invitedBy:c.user.id,role:e.role,url:a}).unwrap().then((a=>{t.Am.success(a.detail),(e=>{const a=localStorage.getItem("invitations");let i={};a&&(i=JSON.parse(a)),i[s]||(i[s]={}),i[s][e]=(new Date).toISOString(),localStorage.setItem("invitations",JSON.stringify(i))})(e.email),o(),h.resetForm()})).catch((e=>{console.dir(e),t.Am.error("Failed to send invitation to user!")}))}});return(0,g.jsxs)(g.Fragment,{children:["admin"===(null===c||void 0===c?void 0:c.role)&&(0,g.jsxs)("div",{className:"user-chat-nav float-end",children:[(0,g.jsx)("div",{id:"add-member",children:(0,g.jsx)(F.Z,{type:"button",color:"link",onClick:o,className:"text-decoration-none text-muted font-size-18 py-0",children:(0,g.jsx)("i",{className:"ri-user-add-line"})})}),(0,g.jsx)(L.Z,{target:"add-member",placement:"bottom",children:e("Add Member")})]}),(0,g.jsxs)(P.Z,{isOpen:a,centered:!0,toggle:o,children:[(0,g.jsx)(U.Z,{tag:"h5",className:"font-size-16",toggle:o,children:e("Add Member")}),(0,g.jsx)(R.Z,{className:"p-4",children:(0,g.jsxs)(G.Z,{id:"user-invite-form",onSubmit:h.handleSubmit,children:[(0,g.jsxs)("div",{className:"mb-4",children:[(0,g.jsx)(D.Z,{className:"form-label",htmlFor:"addcontactemail-input",children:e("Email")}),(0,g.jsx)(b.Z,{name:"email",type:"email",value:h.values.email,className:"form-control",id:"addcontactemail-input",placeholder:e("Enter Email"),onChange:h.handleChange})]}),(0,g.jsxs)("div",{className:"mb-4",children:[(0,g.jsx)(D.Z,{className:"form-label",htmlFor:"role-input",children:e("Role")}),(0,g.jsxs)(b.Z,{name:"role",type:"select",value:h.values.role,className:"form-control",id:"role-input",placeholder:e("Select User Role"),onChange:h.handleChange,children:[(0,g.jsx)("option",{value:"",hidden:!0,children:"-- Select user role --"}),(0,g.jsx)("option",{value:"member",children:"Member"}),(0,g.jsx)("option",{value:"admin",children:"Admin"})]})]})]})}),(0,g.jsxs)(J.Z,{children:[(0,g.jsx)(F.Z,{type:"button",color:"link",onClick:o,children:e("Close")}),(0,g.jsx)(u.Hk,{form:"user-invite-form",buttonText:e("Invite User"),isLoading:d,disabled:!h.isValid,type:"submit",color:"primary"})]})]})]})},ae=()=>{const{t:e}=(0,p.$G)(),{tid:s}=(0,l.UO)(),[a,n]=(0,i.useState)(""),[c,r]=(0,i.useState)([]),{currentMember:d}=(0,i.useContext)(M.p),x=k(a),{data:u,isError:j}=(0,C.LL)({tid:s,search:x});return(0,i.useEffect)((()=>{if(u){const e=(e=>{const s=e.reduce(((e,s)=>{try{const a=s.full_name[0].toUpperCase();e[a]?e[a].children.push(s):e[a]={group:a,children:[s]}}catch(a){return[]}return e}),{});return Object.values(s)})(u);r(e)}j&&t.Am.error("Error fetching team members!")}),[u,j]),(0,g.jsx)(i.Fragment,{children:(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"p-4",children:[(0,g.jsx)(se,{}),(0,g.jsx)("h4",{className:"mb-4",children:e("Members")}),(0,g.jsx)("div",{className:"search-box chat-search-box",children:(0,g.jsxs)(f.Z,{size:"lg",className:"bg-light rounded-lg",children:[(0,g.jsx)(F.Z,{color:"link",className:"text-decoration-none text-muted pr-1",type:"button",children:(0,g.jsx)("i",{className:"ri-search-line search-icon font-size-18"})}),(0,g.jsx)(b.Z,{type:"text",onChange:e=>{var s;const a=null===(s=e.target)||void 0===s?void 0:s.value;n(a)},className:"form-control bg-light",placeholder:e("Search members..")})]})})]}),(0,g.jsx)(Z.Z,{style:{maxHeight:"100%"},id:"chat-room",className:"p-4 chat-message-list chat-group-list",children:c.map(((s,a)=>(0,g.jsxs)("div",{className:0===a?"":"mt-3",children:[(0,g.jsx)("div",{className:"p-3 fw-bold text-primary",children:s.group}),(0,g.jsx)("ul",{className:"list-unstyled contact-list",children:s.children.map((s=>(0,g.jsx)("li",{children:(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("div",{className:"flex-grow-1",children:(0,g.jsx)("h5",{className:"font-size-14 m-0",children:s.display_name})}),"admin"===(null===d||void 0===d?void 0:d.role)&&(0,g.jsxs)(X.Z,{children:[(0,g.jsx)(m.Z,{tag:"a",className:"text-muted",children:(0,g.jsx)("i",{className:"ri-more-2-fill"})}),(0,g.jsxs)(o.Z,{className:"dropdown-menu-end",children:[(0,g.jsxs)(h.Z,{children:[e("Edit")," ",(0,g.jsx)("i",{className:"ri-edit-line float-end text-muted"})]}),s.user.id!==(null===d||void 0===d?void 0:d.user.id)&&(0,g.jsxs)(h.Z,{children:[e("Remove")," ",(0,g.jsx)("i",{className:"ri-delete-bin-line float-end text-muted"})]})]})]})]})},s.id)))})]},a)))})]})})},ie=ae;const le=function(e){const[s,a]=(0,i.useState)(!1),[l,t]=(0,i.useState)(!0),[n,c]=(0,i.useState)(!1),[r,N]=(0,i.useState)(!1),[v,f]=(0,i.useState)(!1),{t:C}=(0,p.$G)();return(0,g.jsx)(i.Fragment,{children:(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"px-4 pt-4",children:(0,g.jsx)("h4",{className:"mb-0",children:C("Settings")})}),(0,g.jsxs)("div",{className:"text-center border-bottom p-4",children:[(0,g.jsxs)("div",{className:"mb-4 profile-user",children:[(0,g.jsx)("img",{src:j,className:"rounded-circle avatar-lg img-thumbnail",alt:"chatvia"}),(0,g.jsx)(F.Z,{type:"button",color:"light",className:"avatar-xs p-0 rounded-circle profile-photo-edit",children:(0,g.jsx)("i",{className:"ri-pencil-fill"})})]}),(0,g.jsx)("h5",{className:"font-size-16 mb-1 text-truncate",children:C("Patricia Smith")}),(0,g.jsxs)(d.Z,{isOpen:s,toggle:()=>a(!s),className:"d-inline-block mb-1",children:[(0,g.jsxs)(m.Z,{tag:"a",className:"text-muted pb-1 d-block",children:[C("Available")," ",(0,g.jsx)("i",{className:"mdi mdi-chevron-down"})]}),(0,g.jsxs)(o.Z,{children:[(0,g.jsx)(h.Z,{children:C("Available")}),(0,g.jsx)(h.Z,{children:C("Busy")})]})]})]}),(0,g.jsx)(Z.Z,{style:{maxHeight:"100%"},className:"p-4 user-profile-desc",children:(0,g.jsxs)("div",{id:"profile-setting-accordion",className:"custom-accordion",children:[(0,g.jsx)(x.Z,{className:"accordion-item border mb-2",children:(0,g.jsxs)(u.zd,{title:"Personal Info",isOpen:l,toggleCollapse:()=>{t(!l),c(!1),N(!1),f(!1)},children:[(0,g.jsx)("div",{className:"float-end",children:(0,g.jsxs)(F.Z,{color:"light",size:"sm",type:"button",children:[(0,g.jsx)("i",{className:"ri-edit-fill me-1 align-middle"})," ",C("Edit")]})}),(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-muted mb-1",children:C("Name")}),(0,g.jsx)("h5",{className:"font-size-14",children:C("Patricia Smith")})]}),(0,g.jsxs)("div",{className:"mt-4",children:[(0,g.jsx)("p",{className:"text-muted mb-1",children:C("Email")}),(0,g.jsx)("h5",{className:"font-size-14",children:C("adc@123.com")})]}),(0,g.jsxs)("div",{className:"mt-4",children:[(0,g.jsx)("p",{className:"text-muted mb-1",children:C("Time")}),(0,g.jsx)("h5",{className:"font-size-14",children:C("11:40 AM")})]}),(0,g.jsxs)("div",{className:"mt-4",children:[(0,g.jsx)("p",{className:"text-muted mb-1",children:C("Location")}),(0,g.jsx)("h5",{className:"font-size-14 mb-0",children:C("California, USA")})]})]})}),(0,g.jsx)(x.Z,{className:"accordion-item border mb-2",children:(0,g.jsxs)(u.zd,{title:"Privacy",isOpen:n,toggleCollapse:()=>{c(!n),t(!1),N(!1),f(!1)},children:[(0,g.jsx)("div",{className:"py-3",children:(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("div",{className:"flex-grow-1 overflow-hidden",children:(0,g.jsx)("h5",{className:"font-size-13 mb-0 text-truncate",children:C("Profile photo")})}),(0,g.jsxs)(X.Z,{className:"ms-2",children:[(0,g.jsxs)(m.Z,{className:"btn btn-light btn-sm w-sm",tag:"button",children:[C("Everyone")," ",(0,g.jsx)("i",{className:"mdi mdi-chevron-down"})]}),(0,g.jsxs)(o.Z,{className:"dropdown-menu-end",children:[(0,g.jsx)(h.Z,{children:C("Everyone")}),(0,g.jsx)(h.Z,{children:C("selected")}),(0,g.jsx)(h.Z,{children:C("Nobody")})]})]})]})}),(0,g.jsx)("div",{className:"py-3 border-top",children:(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("div",{className:"flex-grow-1 overflow-hidden",children:(0,g.jsx)("h5",{className:"font-size-13 mb-0 text-truncate",children:C("Last seen")})}),(0,g.jsx)("div",{className:"ms-2",children:(0,g.jsxs)("div",{className:"form-check form-switch",children:[(0,g.jsx)(b.Z,{type:"checkbox",className:"form-check-input",id:"privacy-lastseenSwitch",defaultChecked:!0}),(0,g.jsx)(D.Z,{className:"form-check-label",htmlFor:"privacy-lastseenSwitch"})]})})]})}),(0,g.jsx)("div",{className:"py-3 border-top",children:(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("div",{className:"flex-grow-1 overflow-hidden",children:(0,g.jsx)("h5",{className:"font-size-13 mb-0 text-truncate",children:C("Status")})}),(0,g.jsxs)(X.Z,{className:"ms-2",children:[(0,g.jsxs)(m.Z,{className:"btn btn-light btn-sm w-sm",tag:"button",children:[C("Everyone")," ",(0,g.jsx)("i",{className:"mdi mdi-chevron-down"})]}),(0,g.jsxs)(o.Z,{className:"dropdown-menu-end",children:[(0,g.jsx)(h.Z,{children:C("Everyone")}),(0,g.jsx)(h.Z,{children:C("selected")}),(0,g.jsx)(h.Z,{children:C("Nobody")})]})]})]})}),(0,g.jsx)("div",{className:"py-3 border-top",children:(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("div",{className:"flex-grow-1 overflow-hidden",children:(0,g.jsx)("h5",{className:"font-size-13 mb-0 text-truncate",children:C("Read receipts")})}),(0,g.jsx)("div",{className:"ms-2",children:(0,g.jsxs)("div",{className:"form-check form-switch",children:[(0,g.jsx)(b.Z,{type:"checkbox",className:"form-check-input",id:"privacy-readreceiptSwitch",defaultChecked:!0}),(0,g.jsx)(D.Z,{className:"form-check-label",htmlFor:"privacy-readreceiptSwitch"})]})})]})}),(0,g.jsx)("div",{className:"py-3 border-top",children:(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("div",{className:"flex-grow-1 overflow-hidden",children:(0,g.jsx)("h5",{className:"font-size-13 mb-0 text-truncate",children:C("Groups")})}),(0,g.jsxs)(X.Z,{className:"ms-2",children:[(0,g.jsxs)(m.Z,{className:"btn btn-light btn-sm w-sm",tag:"button",children:[C("Everyone")," ",(0,g.jsx)("i",{className:"mdi mdi-chevron-down"})]}),(0,g.jsxs)(o.Z,{className:"dropdown-menu-end",children:[(0,g.jsx)(h.Z,{children:C("Everyone")}),(0,g.jsx)(h.Z,{children:C("selected")}),(0,g.jsx)(h.Z,{children:C("Nobody")})]})]})]})})]})}),(0,g.jsx)(x.Z,{className:"accordion-item border mb-2",children:(0,g.jsx)(u.zd,{title:"Security",isOpen:r,toggleCollapse:()=>{N(!r),t(!1),c(!1),f(!1)},children:(0,g.jsx)("div",{children:(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("div",{className:"flex-grow-1 overflow-hidden",children:(0,g.jsx)("h5",{className:"font-size-13 mb-0 text-truncate",children:C("Show security notification")})}),(0,g.jsx)("div",{className:"ms-2 me-0",children:(0,g.jsxs)("div",{className:"form-check form-switch",children:[(0,g.jsx)(b.Z,{type:"checkbox",className:"form-check-input",id:"security-notificationswitch"}),(0,g.jsx)(D.Z,{className:"form-check-label",htmlFor:"security-notificationswitch"})]})})]})})})}),(0,g.jsx)(x.Z,{className:"accordion-item  border mb-2",children:(0,g.jsx)(u.zd,{title:"Help",isOpen:v,toggleCollapse:()=>{f(!v),t(!1),N(!1),c(!1)},children:(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"py-3",children:(0,g.jsx)("h5",{className:"font-size-13 mb-0",children:(0,g.jsx)(y.rU,{to:"#",className:"text-body d-block",children:C("FAQs")})})}),(0,g.jsx)("div",{className:"py-3 border-top",children:(0,g.jsx)("h5",{className:"font-size-13 mb-0",children:(0,g.jsx)(y.rU,{to:"#",className:"text-body d-block",children:C("Contact")})})}),(0,g.jsx)("div",{className:"py-3 border-top",children:(0,g.jsx)("h5",{className:"font-size-13 mb-0",children:(0,g.jsx)(y.rU,{to:"#",className:"text-body d-block",children:C("Terms & Privacy policy")})})})]})})})]})})]})})},te=()=>{const e=(0,n.C)((e=>e.layout.activeTab)),s=[{id:"pills-user",tabId:"profile",component:(0,g.jsx)(N,{})},{id:"pills-chat",tabId:"chat",component:(0,g.jsx)(O,{})},{id:"pills-groups",tabId:"group",component:(0,g.jsx)(W,{})},{id:"pills-members",tabId:"members",component:(0,g.jsx)(ie,{})},{id:"pills-setting",tabId:"settings",component:(0,g.jsx)(le,{})}];return(0,g.jsx)("div",{className:"chat-leftsidebar me-lg-1",children:(0,g.jsx)(c.Z,{activeTab:e,children:s.map((e=>(0,g.jsx)(r.Z,{tabId:e.tabId,id:e.id,children:e.component},e.tabId)))})})};const ne=function(e){return function(s){let a=(0,l.TH)(),i=(0,l.s0)(),t=(0,l.UO)();return(0,g.jsx)(e,(0,v.Z)((0,v.Z)({},s),{},{router:{location:a,navigate:i,params:t}}))}};var ce=a(4555),re=a(2269),de=a(5234);const me=e=>{let{activeUser:s}=e;const a=(0,n.T)(),{t:l}=(0,p.$G)(),t=((0,n.C)((e=>e.chat.users)),(0,n.C)((e=>e.layout.userSidebar))),[c,r]=(0,i.useState)(!0),[d,m]=(0,i.useState)(!1),[o,h]=(0,i.useState)(!1),[j]=(0,i.useState)([{name:"Admin-A.zip",size:"12.5 MB",thumbnail:"ri-file-text-fill"},{name:"Image-1.jpg",size:"4.2 MB",thumbnail:"ri-image-fill"},{name:"Image-2.jpg",size:"3.1 MB",thumbnail:"ri-image-fill"},{name:"Landing-A.zip",size:"6.7 MB",thumbnail:"ri-file-text-fill"}]);return(0,g.jsx)(i.Fragment,{children:(0,g.jsxs)("div",{style:{display:t?"block":"none"},className:"user-profile-sidebar",children:[(0,g.jsx)("div",{className:"px-3 px-lg-4 pt-3 pt-lg-4",children:(0,g.jsx)("div",{className:"user-chat-nav text-end",children:(0,g.jsx)(F.Z,{color:"none",type:"button",onClick:()=>{a((0,re.Sm)())},className:"nav-btn",id:"user-profile-hide",children:(0,g.jsx)("i",{className:"ri-close-line"})})})}),(0,g.jsxs)("div",{className:"text-center p-4 border-bottom",children:[(0,g.jsx)("div",{className:"mb-4 d-flex justify-content-center",children:"Null"===s.profilePicture?(0,g.jsx)("div",{className:"avatar-lg",children:(0,g.jsx)("span",{className:"avatar-title rounded-circle bg-primary-subtle text-primary font-size-24",children:s.name.charAt(0)})}):(0,g.jsx)("img",{src:s.profilePicture,className:"rounded-circle avatar-lg img-thumbnail",alt:"chatvia"})}),(0,g.jsx)("h5",{className:"font-size-16 mb-1 text-truncate",children:s.name}),(0,g.jsxs)("p",{className:"text-muted text-truncate mb-1",children:[(()=>{switch(s.status){case"online":return(0,g.jsx)("i",{className:"ri-record-circle-fill font-size-10 text-success me-1"});case"away":return(0,g.jsx)("i",{className:"ri-record-circle-fill font-size-10 text-warning me-1"});case"offline":return(0,g.jsx)("i",{className:"ri-record-circle-fill font-size-10 text-secondary me-1"});default:return null}})(),"Active"]})]}),(0,g.jsxs)(Z.Z,{style:{maxHeight:"100%"},className:"p-4 user-profile-desc",children:[(0,g.jsx)("div",{className:"text-muted",children:(0,g.jsxs)("p",{className:"mb-4",children:['"',l("If several languages coalesce, the grammar of the resulting language is more simple and regular than that of the individual."),'"']})}),(0,g.jsxs)("div",{id:"profile-user-accordion",className:"custom-accordion",children:[(0,g.jsx)(x.Z,{className:"shadow-none border mb-2",children:(0,g.jsxs)(ce.Z,{title:"About",iconClass:"ri-user-2-line",isOpen:c,toggleCollapse:()=>{r(!c),m(!1),h(!1)},children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-muted mb-1",children:l("Name")}),(0,g.jsx)("h5",{className:"font-size-14",children:s.name})]}),(0,g.jsxs)("div",{className:"mt-4",children:[(0,g.jsx)("p",{className:"text-muted mb-1",children:l("Email")}),(0,g.jsx)("h5",{className:"font-size-14",children:s.email})]}),(0,g.jsxs)("div",{className:"mt-4",children:[(0,g.jsx)("p",{className:"text-muted mb-1",children:l("Time")}),(0,g.jsx)("h5",{className:"font-size-14",children:"11:40 AM"})]}),(0,g.jsxs)("div",{className:"mt-4",children:[(0,g.jsx)("p",{className:"text-muted mb-1",children:l("Location")}),(0,g.jsx)("h5",{className:"font-size-14 mb-0",children:"California, USA"})]})]})}),(0,g.jsx)(x.Z,{className:"mb-1 shadow-none border",children:(0,g.jsx)(ce.Z,{title:"Attached Files",iconClass:"ri-attachment-line",isOpen:d,toggleCollapse:()=>{m(!d),r(!1),h(!1)},children:(0,g.jsx)(u.We,{files:j})})}),s.isGroup&&(0,g.jsx)(x.Z,{className:"mb-1 shadow-none border",children:(0,g.jsxs)(ce.Z,{title:"Members",iconClass:"ri-group-line",isOpen:o,toggleCollapse:()=>{h(!o),r(!1),m(!1)},children:[(0,g.jsx)(x.Z,{className:"p-2 mb-2",children:(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("div",{className:"align-self-center me-3",children:(0,g.jsx)("div",{className:"avatar-xs",children:(0,g.jsx)("span",{className:"avatar-title rounded-circle bg-primary-subtle text-primary",children:"S"})})}),(0,g.jsx)("div",{children:(0,g.jsxs)("h5",{className:"font-size-14 mb-1",children:[l("Sera Mullar"),(0,g.jsx)(Q.Z,{color:"danger",className:"badge-soft-danger float-end",children:l("Admin")})]})})]})}),(0,g.jsx)(x.Z,{className:"p-2 mb-2",children:(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("div",{className:"align-self-center me-3",children:(0,g.jsx)("div",{className:"avatar-xs",children:(0,g.jsx)("span",{className:"avatar-title rounded-circle bg-primary-subtle text-primary",children:"O"})})}),(0,g.jsx)("div",{children:(0,g.jsx)("h5",{className:"font-size-14 mb-1",children:l("Ossie Wilson")})})]})}),(0,g.jsx)(x.Z,{className:"p-2 mb-2",children:(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("img",{src:de,className:"rounded-circle chat-user-img avatar-xs me-3",alt:"chatvia"}),(0,g.jsx)("div",{children:(0,g.jsx)("h5",{className:"font-size-14 mb-1",children:l("Paul Haynes")})})]})})]})})]})]})]})})};var oe=a(4899),he=a(6782),xe=a(5399);const ue=()=>{var e;const[s,a]=(0,i.useState)({main:!1,more:!1,callModal:!1,videoModal:!1}),{activeChatRoom:l}=(0,i.useContext)(M.p),t=(0,n.T)(),c=e=>a((s=>(0,v.Z)((0,v.Z)({},s),{},{[e]:!s[e]}))),r=e=>{e.preventDefault(),t((0,re.PE)())};return(0,g.jsxs)("div",{className:"p-3 p-lg-4 border-bottom user-chat-topbar",children:[(0,g.jsxs)(he.Z,{className:"align-items-center",children:[(0,g.jsx)(xe.Z,{sm:4,xs:8,children:(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[null!==l&&void 0!==l&&l.participant_profile_pic?(0,g.jsx)("div",{className:"me-3",children:(0,g.jsx)("img",{src:(null===l||void 0===l?void 0:l.participant_profile_pic)||"",className:"rounded-circle avatar-xs",alt:"tochly"})}):(0,g.jsx)("div",{className:"chat-user-img align-self-center me-3",children:(0,g.jsx)("div",{className:"avatar-xs",children:(0,g.jsx)("span",{className:"avatar-title rounded-circle bg-primary-subtle text-primary",children:null===l||void 0===l||null===(e=l.participant_name)||void 0===e?void 0:e.charAt(0)})})}),(0,g.jsx)("div",{className:"flex-grow-1 overflow-hidden",children:(0,g.jsxs)("h5",{className:"font-size-16 mb-0 text-truncate",children:[(0,g.jsx)(y.rU,{to:"#",onClick:r,className:"text-reset user-profile-show",children:null===l||void 0===l?void 0:l.participant_name}),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"false";return e&&(0,g.jsx)("i",{className:"ri-record-circle-fill font-size-10 ".concat({true:"text-success",false:"text-secondary"}[e]," d-inline-block ms-2")})}(String(null===l||void 0===l?void 0:l.is_participant_online))]})})]})}),(0,g.jsx)(xe.Z,{sm:8,xs:4,children:(0,g.jsxs)("ul",{className:"list-inline user-chat-nav text-end mb-0",children:[(0,g.jsx)("li",{className:"list-inline-item",children:(0,g.jsxs)(d.Z,{isOpen:s.main,toggle:()=>c("main"),children:[(0,g.jsx)(m.Z,{color:"none",className:"btn nav-btn",children:(0,g.jsx)("i",{className:"ri-search-line"})}),(0,g.jsx)(o.Z,{className:"p-0 dropdown-menu-end dropdown-menu-md",children:(0,g.jsx)("div",{className:"search-box p-2",children:(0,g.jsx)(b.Z,{type:"text",className:"form-control bg-light border-0",placeholder:"Search.."})})})]})}),(0,g.jsx)("li",{className:"list-inline-item d-none d-lg-inline-block me-2",children:(0,g.jsx)("button",{type:"button",onClick:()=>c("callModal"),className:"btn nav-btn",children:(0,g.jsx)("i",{className:"ri-phone-line"})})}),(0,g.jsx)("li",{className:"list-inline-item d-none d-lg-inline-block me-2",children:(0,g.jsx)("button",{type:"button",onClick:()=>c("videoModal"),className:"btn nav-btn",children:(0,g.jsx)("i",{className:"ri-vidicon-line"})})}),(0,g.jsx)("li",{className:"list-inline-item",children:(0,g.jsxs)(d.Z,{isOpen:s.more,toggle:()=>c("more"),children:[(0,g.jsx)(m.Z,{color:"none",className:"btn nav-btn",children:(0,g.jsx)("i",{className:"ri-more-fill"})}),(0,g.jsxs)(o.Z,{className:"dropdown-menu-end",children:[(0,g.jsxs)(h.Z,{onClick:r,children:["View Profile ",(0,g.jsx)("i",{className:"ri-user-2-line float-end text-muted"})]}),(0,g.jsxs)(h.Z,{children:["Archive ",(0,g.jsx)("i",{className:"ri-archive-line float-end text-muted"})]}),(0,g.jsxs)(h.Z,{children:["Muted ",(0,g.jsx)("i",{className:"ri-volume-mute-line float-end text-muted"})]}),(0,g.jsxs)(h.Z,{onClick:()=>{},children:["Delete ",(0,g.jsx)("i",{className:"ri-delete-bin-line float-end text-muted"})]})]})]})})]})})]}),(0,g.jsx)(P.Z,{isOpen:s.callModal,toggle:()=>c("callModal"),centered:!0,children:(0,g.jsx)(R.Z,{children:(0,g.jsxs)("div",{className:"text-center p-4",children:[(0,g.jsx)("div",{className:"avatar-lg mx-auto mb-4",children:(null===l||void 0===l?void 0:l.participant_profile_pic)&&(0,g.jsx)("img",{src:l.participant_profile_pic,alt:"Avatar",className:"img-thumbnail rounded-circle"})}),(0,g.jsx)("h5",{className:"text-truncate",children:(null===l||void 0===l?void 0:l.participant_name)||"User"}),(0,g.jsx)("p",{className:"text-muted",children:"Start Audio Call"}),(0,g.jsxs)("div",{className:"mt-5",children:[(0,g.jsx)("button",{type:"button",className:"btn btn-danger avatar-sm rounded-circle",onClick:()=>c("callModal"),children:(0,g.jsx)("i",{className:"ri-close-fill"})}),(0,g.jsx)("button",{type:"button",className:"btn btn-success avatar-sm rounded-circle",children:(0,g.jsx)("i",{className:"ri-phone-fill"})})]})]})})}),(0,g.jsx)(P.Z,{isOpen:s.videoModal,toggle:()=>c("videoModal"),centered:!0,children:(0,g.jsx)(R.Z,{children:(0,g.jsxs)("div",{className:"text-center p-4",children:[(0,g.jsx)("div",{className:"avatar-lg mx-auto mb-4",children:(null===l||void 0===l?void 0:l.participant_profile_pic)&&(0,g.jsx)("img",{src:l.participant_profile_pic,alt:"Avatar",className:"img-thumbnail rounded-circle"})}),(0,g.jsx)("h5",{className:"text-truncate",children:(null===l||void 0===l?void 0:l.participant_name)||"Unkown"}),(0,g.jsx)("p",{className:"text-muted",children:"Start Video Call"}),(0,g.jsxs)("div",{className:"mt-5",children:[(0,g.jsx)("button",{type:"button",className:"btn btn-danger avatar-sm rounded-circle",onClick:()=>c("videoModal"),children:(0,g.jsx)("i",{className:"ri-close-fill"})}),(0,g.jsx)("button",{type:"button",className:"btn btn-success avatar-sm rounded-circle",children:(0,g.jsx)("i",{className:"ri-vidicon-fill"})})]})]})})})]})};const je=function(e){const[s,a]=(0,i.useState)(!1),[l,t]=(0,i.useState)(null),[n]=(0,i.useState)(e.images),{t:c}=(0,p.$G)();return(0,g.jsx)(i.Fragment,{children:(0,g.jsx)("ul",{className:"list-inline message-img  mb-0",children:n.map(((e,i)=>(0,g.jsxs)("li",{className:"list-inline-item message-img-list",children:[(0,g.jsx)("div",{children:(0,g.jsx)(y.rU,{to:"#",onClick:()=>(e=>{a(!s),t(e)})(e.image),className:"popup-img d-inline-block m-1",title:"Project 1",children:(0,g.jsx)("img",{src:e.image,alt:"chat",className:"rounded border"})})}),(0,g.jsx)("div",{className:"message-img-link",children:(0,g.jsxs)("ul",{className:"list-inline mb-0",children:[(0,g.jsx)("li",{className:"list-inline-item",children:(0,g.jsx)(y.rU,{to:"#",children:(0,g.jsx)("i",{className:"ri-download-2-line"})})}),(0,g.jsxs)(X.Z,{tag:"li",className:"list-inline-item",children:[(0,g.jsx)(m.Z,{tag:"a",children:(0,g.jsx)("i",{className:"ri-more-fill"})}),(0,g.jsxs)(o.Z,{className:"dropdown-menu-end",children:[(0,g.jsxs)(h.Z,{children:[c("Copy")," ",(0,g.jsx)("i",{className:"ri-file-copy-line float-end text-muted"})]}),(0,g.jsxs)(h.Z,{children:[c("Save")," ",(0,g.jsx)("i",{className:"ri-save-line float-end text-muted"})]}),(0,g.jsxs)(h.Z,{children:[c("Forward")," ",(0,g.jsx)("i",{className:"ri-chat-forward-line float-end text-muted"})]}),(0,g.jsxs)(h.Z,{children:[c("Delete")," ",(0,g.jsx)("i",{className:"ri-delete-bin-line float-end text-muted"})]})]})]})]})})]},i)))})})};var pe=a(4889),ge=a(3371);const Ne=function(e){const[s,a]=(0,i.useState)(""),[l,t]=(0,i.useState)(!1),[n,c]=(0,i.useState)({name:"",size:""}),[r,d]=(0,i.useState)("");return(0,g.jsx)(i.Fragment,{children:(0,g.jsx)("div",{className:"chat-input-section p-3 p-lg-4 border-top mb-0 ",children:(0,g.jsx)(G.Z,{onSubmit:i=>((s,i)=>{s.preventDefault(),""!==i&&(e.onaddMessage(i,"textMessage"),a("")),""!==n.name&&(e.onaddMessage(n,"fileMessage"),c({name:"",size:""})),""!==r&&(e.onaddMessage(r,"imageMessage"),d(""))})(i,s),children:(0,g.jsxs)(he.Z,{className:"g-0",children:[(0,g.jsx)(xe.Z,{children:(0,g.jsx)("div",{children:(0,g.jsx)(b.Z,{type:"text",value:s,onChange:e=>{a(e.target.value)},className:"form-control form-control-lg bg-light border-light",placeholder:"Enter Message..."})})}),(0,g.jsx)(xe.Z,{xs:"auto",children:(0,g.jsx)("div",{className:"chat-input-links ms-md-2",children:(0,g.jsxs)("ul",{className:"list-inline mb-0 ms-0",children:[(0,g.jsxs)("li",{className:"list-inline-item",children:[(0,g.jsxs)(pe.Z,{className:"emoji-dropdown",direction:"up",isOpen:l,toggle:()=>t(!l),children:[(0,g.jsx)(m.Z,{id:"emoji",color:"link",className:"text-decoration-none font-size-16 btn-lg waves-effect",children:(0,g.jsx)("i",{className:"ri-emotion-happy-line"})}),(0,g.jsx)(o.Z,{className:"dropdown-menu-end",children:(0,g.jsx)(ge.ZP,{onEmojiClick:e=>{a(s+e.emoji)}})})]}),(0,g.jsx)(L.Z,{target:"emoji",placement:"top",children:"Emoji"})]}),(0,g.jsxs)("li",{className:"list-inline-item input-file",children:[(0,g.jsxs)(D.Z,{id:"files",className:"btn btn-link text-decoration-none font-size-16 btn-lg waves-effect",children:[(0,g.jsx)("i",{className:"ri-attachment-line"}),(0,g.jsx)(b.Z,{onChange:e=>(e=>{0!==e.target.files.length&&c({name:e.target.files[0].name,size:e.target.files[0].size})})(e),type:"file",name:"fileInput",size:60})]}),(0,g.jsx)(L.Z,{target:"files",placement:"top",children:"Attached File"})]}),(0,g.jsxs)("li",{className:"list-inline-item input-file",children:[(0,g.jsxs)(D.Z,{id:"images",className:"me-1 btn btn-link text-decoration-none font-size-16 btn-lg waves-effect",children:[(0,g.jsx)("i",{className:"ri-image-fill"}),(0,g.jsx)(b.Z,{onChange:e=>(e=>{0!==e.target.files.length&&d(URL.createObjectURL(e.target.files[0]))})(e),accept:"image/*",type:"file",name:"fileInput",size:60})]}),(0,g.jsx)(L.Z,{target:"images",placement:"top",children:"Images"})]}),(0,g.jsx)("li",{className:"list-inline-item",children:(0,g.jsx)(F.Z,{type:"submit",color:"primary",className:"font-size-16 btn-lg chat-send waves-effect waves-light",children:(0,g.jsx)("i",{className:"ri-send-plane-2-fill"})})})]})})})]})})})})};const ve=function(e){const{t:s}=(0,p.$G)();return(0,g.jsx)(i.Fragment,{children:(0,g.jsx)(x.Z,{className:"p-2 mb-2",children:(0,g.jsxs)("div",{className:"d-flex align-items-center",children:[(0,g.jsx)("div",{className:"avatar-sm me-3 ms-0",children:(0,g.jsx)("div",{className:"avatar-title bg-primary-subtle text-primary rounded font-size-20",children:(0,g.jsx)("i",{className:"ri-file-text-fill"})})}),(0,g.jsx)("div",{className:"flex-grow-1",children:(0,g.jsxs)("div",{className:"text-start",children:[(0,g.jsx)("h5",{className:"font-size-14 mb-1",children:e.fileName}),(0,g.jsx)("p",{className:"text-muted font-size-13 mb-0",children:e.fileSize})]})}),(0,g.jsx)("div",{className:"ms-4",children:(0,g.jsxs)("ul",{className:"list-inline mb-0 font-size-20",children:[(0,g.jsx)("li",{className:"list-inline-item",children:(0,g.jsx)(y.rU,{to:"#",className:"text-muted",children:(0,g.jsx)("i",{className:"ri-download-2-line"})})}),(0,g.jsxs)(X.Z,{tag:"li",className:"list-inline-item",children:[(0,g.jsx)(m.Z,{tag:"a",className:"dropdown-toggle text-muted",children:(0,g.jsx)("i",{className:"ri-more-fill"})}),(0,g.jsxs)(o.Z,{className:"dropdown-menu-end",children:[(0,g.jsxs)(h.Z,{children:[s("Share")," ",(0,g.jsx)("i",{className:"ri-share-line float-end text-muted"})]}),(0,g.jsxs)(h.Z,{children:[s("Delete")," ",(0,g.jsx)("i",{className:"ri-delete-bin-line float-end text-muted"})]})]})]})]})})]})})})};var fe=a(7827);const be=ne((e=>{const s=(0,n.T)(),a=(0,i.useRef)(null),[l,t]=(0,i.useState)(!1),{active_user:c}=(0,n.C)((e=>e.chat)),{userSidebar:r}=(0,n.C)((e=>e.layout)),{t:d}=(0,p.$G)(),[x]=(0,i.useState)(e.recentChatList),[u,N]=(0,i.useState)(e.recentChatList[c].messages);console.log("chatMessages",u),(0,i.useEffect)((()=>{N(e.recentChatList[c].messages),a.current.recalculate(),a.current.el&&(a.current.getScrollElement().scrollTop=a.current.getScrollElement().scrollHeight)}),[c,e.recentChatList]);const v=()=>t(!l),f=()=>{a.current.el&&(a.current.getScrollElement().scrollTop=a.current.getScrollElement().scrollHeight)},b=e=>{var s=u.filter((function(s){return s.id!==e}));N(s)};return(0,g.jsx)(i.Fragment,{children:(0,g.jsx)("div",{className:"user-chat w-100 overflow-hidden",children:(0,g.jsxs)("div",{className:"d-lg-flex",children:[(0,g.jsxs)("div",{className:r?"w-70 overflow-hidden position-relative":"w-100 overflow-hidden position-relative",children:[(0,g.jsx)(ue,{}),(0,g.jsx)(Z.Z,{style:{maxHeight:"100%"},ref:a,className:"chat-conversation p-5 p-lg-4",id:"messages",children:(0,g.jsx)("ul",{className:"list-unstyled mb-0",children:u.map(((s,a)=>s.isToday&&!0===s.isToday?(0,g.jsx)("li",{children:(0,g.jsx)("div",{className:"chat-day-title",children:(0,g.jsx)("span",{className:"title",children:"Today"})})},"dayTitle"+a):!0===e.recentChatList[c].isGroup?(0,g.jsx)("li",{className:"sender"===s.userType?"right":"",children:(0,g.jsxs)("div",{className:"conversation-list",children:[(0,g.jsx)("div",{className:"chat-avatar",children:"sender"===s.userType?(0,g.jsx)("img",{src:j,alt:"chatvia"}):"Null"===e.recentChatList[c].profilePicture?(0,g.jsx)("div",{className:"chat-user-img align-self-center me-3",children:(0,g.jsx)("div",{className:"avatar-xs",children:(0,g.jsx)("span",{className:"avatar-title rounded-circle bg-primary-subtle text-primary",children:s.userName&&s.userName.charAt(0)})})}):(0,g.jsx)("img",{src:e.recentChatList[c].profilePicture,alt:"chatvia"})}),(0,g.jsxs)("div",{className:"user-chat-content",children:[(0,g.jsxs)("div",{className:"ctext-wrap",children:[(0,g.jsxs)("div",{className:"ctext-wrap-content",children:[s.message&&(0,g.jsx)("p",{className:"mb-0",children:s.message}),s.imageMessage&&(0,g.jsx)(je,{images:s.imageMessage}),s.fileMessage&&(0,g.jsx)(ve,{fileName:s.fileMessage,fileSize:s.size}),s.isTyping&&(0,g.jsxs)("p",{className:"mb-0",children:["typing",(0,g.jsxs)("span",{className:"animate-typing",children:[(0,g.jsx)("span",{className:"dot ms-1"}),(0,g.jsx)("span",{className:"dot ms-1"}),(0,g.jsx)("span",{className:"dot ms-1"})]})]}),!s.isTyping&&(0,g.jsxs)("p",{className:"chat-time mb-0",children:[(0,g.jsx)("i",{className:"ri-time-line align-middle"})," ",(0,g.jsx)("span",{className:"align-middle",children:s.time})]})]}),!s.isTyping&&(0,g.jsxs)(X.Z,{className:"align-self-start",children:[(0,g.jsx)(m.Z,{tag:"a",className:"text-muted ms-1",children:(0,g.jsx)("i",{className:"ri-more-2-fill"})}),(0,g.jsxs)(o.Z,{children:[(0,g.jsxs)(h.Z,{children:[d("Copy")," ",(0,g.jsx)("i",{className:"ri-file-copy-line float-end text-muted"})]}),(0,g.jsxs)(h.Z,{children:[d("Save")," ",(0,g.jsx)("i",{className:"ri-save-line float-end text-muted"})]}),(0,g.jsxs)(h.Z,{onClick:v,children:["Forward ",(0,g.jsx)("i",{className:"ri-chat-forward-line float-end text-muted"})]}),(0,g.jsxs)(h.Z,{onClick:()=>b(s.id),children:["Delete ",(0,g.jsx)("i",{className:"ri-delete-bin-line float-end text-muted"})]})]})]})]}),(0,g.jsx)("div",{className:"conversation-name",children:"sender"===s.userType?"Patricia Smith":s.userName})]})]})},a):(0,g.jsx)("li",{className:"sender"===s.userType?"right":"",children:(0,g.jsxs)("div",{className:"conversation-list",children:[u[a+1]&&u[a].userType===u[a+1].userType?(0,g.jsx)("div",{className:"chat-avatar",children:(0,g.jsx)("div",{className:"blank-div"})}):(0,g.jsx)("div",{className:"chat-avatar",children:"sender"===s.userType?(0,g.jsx)("img",{src:j,alt:"chatvia"}):"Null"===e.recentChatList[c].profilePicture?(0,g.jsx)("div",{className:"chat-user-img align-self-center me-3",children:(0,g.jsx)("div",{className:"avatar-xs",children:(0,g.jsx)("span",{className:"avatar-title rounded-circle bg-primary-subtle text-primary",children:e.recentChatList[c].name.charAt(0)})})}):(0,g.jsx)("img",{src:e.recentChatList[c].profilePicture,alt:"chatvia"})}),(0,g.jsxs)("div",{className:"user-chat-content",children:[(0,g.jsxs)("div",{className:"ctext-wrap",children:[(0,g.jsxs)("div",{className:"ctext-wrap-content",children:[s.message&&(0,g.jsx)("p",{className:"mb-0",children:s.message}),s.imageMessage&&(0,g.jsx)(je,{images:s.imageMessage}),s.fileMessage&&(0,g.jsx)(ve,{fileName:s.fileMessage,fileSize:s.size}),s.isTyping&&(0,g.jsxs)("p",{className:"mb-0",children:["typing",(0,g.jsxs)("span",{className:"animate-typing",children:[(0,g.jsx)("span",{className:"dot ms-1"}),(0,g.jsx)("span",{className:"dot ms-1"}),(0,g.jsx)("span",{className:"dot ms-1"})]})]}),!s.isTyping&&(0,g.jsxs)("p",{className:"chat-time mb-0",children:[(0,g.jsx)("i",{className:"ri-time-line align-middle"})," ",(0,g.jsx)("span",{className:"align-middle",children:s.time})]})]}),!s.isTyping&&(0,g.jsxs)(X.Z,{className:"align-self-start ms-1",children:[(0,g.jsx)(m.Z,{tag:"a",className:"text-muted",children:(0,g.jsx)("i",{className:"ri-more-2-fill"})}),(0,g.jsxs)(o.Z,{children:[(0,g.jsxs)(h.Z,{children:[d("Copy")," ",(0,g.jsx)("i",{className:"ri-file-copy-line float-end text-muted"})]}),(0,g.jsxs)(h.Z,{children:[d("Save")," ",(0,g.jsx)("i",{className:"ri-save-line float-end text-muted"})]}),(0,g.jsxs)(h.Z,{onClick:v,children:["Forward ",(0,g.jsx)("i",{className:"ri-chat-forward-line float-end text-muted"})]}),(0,g.jsxs)(h.Z,{onClick:()=>b(s.id),children:["Delete ",(0,g.jsx)("i",{className:"ri-delete-bin-line float-end text-muted"})]})]})]})]}),u[a+1]?u[a].userType===u[a+1].userType?null:(0,g.jsx)("div",{className:"conversation-name",children:"sender"===s.userType?"Patricia Smith":e.recentChatList[c].name}):(0,g.jsx)("div",{className:"conversation-name",children:"sender"===s.userType?"Admin":e.recentChatList[c].name})]})]})},a)))})}),(0,g.jsxs)(P.Z,{backdrop:"static",isOpen:l,centered:!0,toggle:v,children:[(0,g.jsx)(U.Z,{toggle:v,children:"Forward to..."}),(0,g.jsx)(R.Z,{children:(0,g.jsxs)($.Z,{className:"p-2",children:[(0,g.jsx)(Z.Z,{style:{maxHeight:"200px"},children:(0,g.jsx)(oe.Z,{handleCheck:()=>{}})}),(0,g.jsx)(J.Z,{className:"border-0",children:(0,g.jsx)(F.Z,{color:"primary",children:"Forward"})})]})})]}),(0,g.jsx)(Ne,{onaddMessage:(e,a)=>{var i=null;var l=(new Date).getSeconds();switch(a){case"textMessage":i={id:u.length+1,message:e,time:"00:"+l,userType:"sender",image:fe,isFileMessage:!1,isImageMessage:!1};break;case"fileMessage":i={id:u.length+1,message:"file",fileMessage:e.name,size:e.size,time:"00:"+l,userType:"sender",image:fe,isFileMessage:!0,isImageMessage:!1};break;case"imageMessage":var t=[{image:e}];i={id:u.length+1,message:"image",imageMessage:t,size:e.size,time:"00:"+l,userType:"sender",image:fe,isImageMessage:!0,isFileMessage:!1}}N([...u,i]);let n=[...x];n[c].messages=[...u,i],n[c].isTyping=!1,s((0,V.NW)(n)),f()}})]}),(0,g.jsx)(me,{activeUser:e.recentChatList[c]})]})})})})),ye=()=>{const{tid:e}=(0,l.UO)(),{data:s}=(0,S.XC)(),{data:a,isError:c}=(0,C.LL)({tid:e,userId:String(null===s||void 0===s?void 0:s.id)},{skip:!s}),{setCurrentMember:r}=(0,i.useContext)(M.p),d=(0,n.C)((e=>e.chat.users));return(0,i.useEffect)((()=>{c&&t.Am.error("Error fetching team members!"),null!==a&&void 0!==a&&a.length&&r(a[0])}),[a]),i.useEffect((()=>{document.title="Chat | Tochly - Team Chatting application"}),[]),(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)(te,{}),(0,g.jsx)(be,{recentChatList:d})]})};var Ze=a(329);function Ce(){return(0,g.jsx)(Ze.a,{children:(0,g.jsx)(ye,{})})}},5383:(e,s,a)=>{a.d(s,{DS:()=>l,_J:()=>t});const i=a(8880).g.injectEndpoints({endpoints:e=>({sendInvitation:e.mutation({query:e=>{let{tid:s,inviteeEmail:a,role:i,invitedBy:l,url:t}=e;return{url:"/invitations/send-invite/",method:"POST",body:{tid:s,role:i,url:t,invitee_email:a,invited_by:l}}}}),acceptInvitation:e.mutation({query:e=>({url:"/invitations/accept-invite/",method:"POST",body:e})})})}),{useSendInvitationMutation:l,useAcceptInvitationMutation:t}=i},4667:(e,s,a)=>{a.d(s,{E$:()=>t,LL:()=>l,yp:()=>n});const i=a(8880).g.injectEndpoints({endpoints:e=>({getTeamMembers:e.query({query:e=>{let{tid:s,userId:a,search:i}=e;const l=new URLSearchParams;return l.set("limit","50"),i&&l.set("search",i),a&&l.set("user_id",a),"/teams/".concat(s,"/members/?").concat(l.toString())}}),createTeamMember:e.mutation({query:e=>{let{user:s,teamTid:a,display_name:i,role:l}=e;return{url:"/teams/".concat(a,"/members/"),method:"POST",body:{user:s,role:l,display_name:i}}},invalidatesTags:["Team"]})})}),{useGetTeamMembersQuery:l,useLazyGetTeamMembersQuery:t,useCreateTeamMemberMutation:n}=i}}]);