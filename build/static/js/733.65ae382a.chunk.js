"use strict";(self.webpackChunktochly=self.webpackChunktochly||[]).push([[733],{8849:(e,t,r)=>{r.d(t,{s:()=>s});var n=r(7313),a=r(3814);const s=()=>(0,n.useContext)(a.J)},6733:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ke});var n=r(8437),a=r(7313),s=r(2135),i=r(5192),o=r.n(i),c=r(6123),l=r.n(c),u=r(986),d=["expand","className","cssModule","light","dark","fixed","sticky","color","container","tag","children"];function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},m.apply(this,arguments)}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var g={children:o().node,className:o().string,color:o().string,container:o().oneOfType([o().bool,o().string]),cssModule:o().object,dark:o().bool,expand:o().oneOfType([o().bool,o().string]),fixed:o().string,light:o().bool,role:o().string,sticky:o().string,tag:u.iC};function f(e){var t,r=e.expand,n=void 0!==r&&r,s=e.className,i=e.cssModule,o=e.light,c=e.dark,g=e.fixed,f=e.sticky,y=e.color,h=e.container,v=void 0===h?"fluid":h,j=e.tag,O=void 0===j?"nav":j,x=e.children,N=b(e,d),T=(0,u.mx)(l()(s,"navbar",function(e){return!1!==e&&(!0===e||"xs"===e?"navbar-expand":"navbar-expand-".concat(e))}(n),(p(t={"navbar-light":o,"navbar-dark":c},"bg-".concat(y),y),p(t,"fixed-".concat(g),g),p(t,"sticky-".concat(f),f),t)),i),w=v&&!0===v?"container":"container-".concat(v);return a.createElement(O,m({},N,{className:T}),v?a.createElement("div",{className:w},x):x)}f.propTypes=g;const y=f;var h=r(894),v=["className","cssModule","tag"];function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},j.apply(this,arguments)}function O(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var x={className:o().string,cssModule:o().object,tag:u.iC};function N(e){var t=e.className,r=e.cssModule,n=e.tag,s=void 0===n?"a":n,i=O(e,v),o=(0,u.mx)(l()(t,"navbar-brand"),r);return a.createElement(s,j({},i,{className:o}))}N.propTypes=x;const T=N;var w=["className","cssModule","children","tag"];function k(){return k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k.apply(this,arguments)}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var C={className:o().string,cssModule:o().object,tag:u.iC,type:o().string,children:o().node};function M(e){var t=e.className,r=e.cssModule,n=e.children,s=e.tag,i=void 0===s?"button":s,o=S(e,w),c=(0,u.mx)(l()(t,"navbar-toggler"),r);return a.createElement(i,k({"aria-label":"Toggle navigation"},function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){P(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({type:"button"},o),{className:c}),n||a.createElement("span",{className:(0,u.mx)("navbar-toggler-icon",r)}))}M.propTypes=C;const Z=M;var q=r(8683),L=r(2742),_=r(1613),A=["className","cssModule","active","tag"];function G(){return G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},G.apply(this,arguments)}function B(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var D={className:o().string,cssModule:o().object,tag:u.iC,active:o().bool};function I(e){var t=e.className,r=e.cssModule,n=(e.active,e.tag),s=void 0===n?"span":n,i=B(e,A),o=(0,u.mx)(l()(t,"navbar-text"),r);return a.createElement(s,G({},i,{className:o}))}I.propTypes=D;const Q=I;var U=r(5590),K=r(6254),R=r(3503),F=r(1933),V=r(9327),$=r(6707),z=r(2020),H=r(8642),J=r(6597);const W=r(8880).g.injectEndpoints({endpoints:e=>({getTeams:e.query({query:()=>"/teams/",providesTags:["Team"]}),getUserTeams:e.query({query:()=>"/users/teams/",providesTags:["Team"]}),getTeam:e.query({query:e=>"/teams/".concat(e,"/")}),getTeamByName:e.query({query:e=>"/teams?name=".concat(e)}),createTeam:e.mutation({query:e=>{let{name:t,description:r}=e;return{url:"/teams/",method:"POST",body:{name:t,description:r}}},invalidatesTags:["Team"]}),deleteTeam:e.mutation({query:e=>({url:"/teams/".concat(e),method:"DELETE"}),invalidatesTags:["Team"]})})}),{useGetTeamsQuery:X,useGetUserTeamsQuery:Y,useGetTeamQuery:ee,useGetTeamByNameQuery:te,useCreateTeamMutation:re,useDeleteTeamMutation:ne}=W;var ae=r(4667),se=r(2169),ie=r(454);const oe="admin";var ce=r(8754),le=r(8849),ue=r(6417);function de(){const[e,t]=(0,a.useState)(!1),[r,n]=(0,a.useState)(!0),[s,i]=(0,a.useState)(""),{t:o}=(0,U.$G)(),c=(0,le.s)(),[l,{isLoading:u}]=re(),[d,{isLoading:m}]=(0,ae.yp)(),[p,{isLoading:b}]=ne(),{data:g}=te(s,{skip:r}),{data:f}=(0,se.XC)(),y=u||m||b,h=(0,R.TA)({initialValues:{name:"",description:""},validationSchema:F.Ry({name:F.Z_().required(o("Enter team name")),description:F.Z_().required(o("Enter team description"))}),onSubmit:e=>{l({name:e.name,description:e.description||""}).unwrap().then((()=>{i(e.name),n(!1)})).catch((e=>{var t,r;K.Am.error("Team creation failed! ".concat((null===(t=e.data)||void 0===t||null===(r=t.name)||void 0===r?void 0:r[0])||""))}))}}),v=(0,a.useCallback)((()=>{t(!e),e||(h.resetForm(),i(""),n(!0))}),[e,h]),j=(0,a.useCallback)((()=>{if(g&&g.length>0&&f){const e=g[0];d({user:f.id,teamTid:e.tid,role:oe,display_name:"".concat(f.first_name," ").concat(f.last_name)}).unwrap().then((()=>{K.Am.success(o("Team created successfully")),(0,ce.xm)(c,{team_id:e.tid,receiver_id:String(f.id)}),v()})).catch((t=>{var r,n;p(e.tid),K.Am.error("Team creation failed! ".concat((null===(r=t.data)||void 0===r||null===(n=r.name)||void 0===n?void 0:n[0])||""))}))}}),[d,f,p,g,v,o]);return(0,a.useEffect)((()=>{!r&&g&&(j(),n(!0))}),[g,j,r]),(0,ue.jsxs)(ue.Fragment,{children:[(0,ue.jsx)(V.Z,{color:"light",className:"create-team-btn",onClick:v,children:o("CREATE A NEW TEAM")}),(0,ue.jsx)("div",{children:(0,ue.jsxs)($.Z,{isOpen:e,toggle:v,backdrop:"static",keyboard:!1,centered:!0,children:[(0,ue.jsx)(z.Z,{children:o("Create New Team")}),(0,ue.jsx)(H.Z,{children:(0,ue.jsxs)(J.Z,{noValidate:!0,onSubmit:h.handleSubmit,children:[(0,ue.jsx)(ie.BK,{label:o("Name"),fieldName:"name",type:"text",value:h.values.name,inputError:h.errors.name,placeholder:o("Team Name"),classNameInput:"border-secondary",classNameGroup:"mb-3 bg-soft-light rounded-3",invalid:!(!h.touched.name||!h.errors.name),onChange:h.handleChange,onBlur:h.handleBlur}),(0,ue.jsx)(ie.BK,{label:o("Description"),fieldName:"description",type:"textarea",value:h.values.description,inputError:h.errors.description,placeholder:o("Team Description"),classNameInput:"border-secondary",classNameGroup:"mb-3 bg-soft-light rounded-3",invalid:!(!h.touched.description||!h.errors.description),onChange:h.handleChange,onBlur:h.handleBlur}),(0,ue.jsxs)("div",{className:"d-flex w-100",children:[(0,ue.jsx)(V.Z,{color:"secondary",onClick:v,children:o("Close")}),(0,ue.jsx)(ie.Hk,{buttonText:o("Create"),isLoading:y,color:"primary",className:"ms-auto waves-effect waves-light",type:"submit"})]})]})})]})})]})}function me(){const[e,t]=(0,a.useState)(!1),{isAuthenticated:r}=(0,n.C)((e=>e.auth));return(0,ue.jsx)(y,{color:"primary",dark:!0,expand:"lg",className:"custom-navbar shadow-sm py-3",children:(0,ue.jsxs)(h.Z,{children:[(0,ue.jsx)(T,{tag:s.rU,to:"/",className:"fw-bold fs-4 text-white",children:"Tochly"}),(0,ue.jsx)(Z,{onClick:()=>t(!e),"aria-label":"Toggle navigation"}),(0,ue.jsx)(q.Z,{isOpen:e,navbar:!0,children:(0,ue.jsx)(L.Z,{className:"ms-auto align-items-center",navbar:!0,children:(0,ue.jsx)(_.Z,{children:(0,ue.jsx)(Q,{children:r?(0,ue.jsx)(de,{}):(0,ue.jsx)(s.rU,{to:"/auth/login",className:"text-white fw-semibold nav-link-style",children:"Sign in"})})})})})]})})}var pe=r(7969),be=r(6806),ge=r(238),fe=r(3516),ye=["className","cssModule","tag"];function he(){return he=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},he.apply(this,arguments)}function ve(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var je={className:o().string,cssModule:o().object,tag:u.iC};function Oe(e){var t=e.className,r=e.cssModule,n=e.tag,s=void 0===n?"div":n,i=ve(e,ye),o=(0,u.mx)(l()(t,"card-title"),r);return a.createElement(s,he({},i,{className:o}))}Oe.propTypes=je;const xe=Oe;function Ne(){const{data:e,isLoading:t,isError:r}=Y();return t?(0,ue.jsxs)("div",{className:"m-3 text-center",children:[(0,ue.jsx)(pe.Z,{color:"primary"}),(0,ue.jsx)("p",{"aria-label":"loading",children:"Loading..."})]}):r?(0,ue.jsx)("div",{className:"m-3",children:(0,ue.jsx)(be.Z,{color:"danger",children:"Something went wrong. Please try again later."})}):(0,ue.jsx)("div",{className:"m-3",children:(0,ue.jsx)("div",{className:"landing-page",children:(0,ue.jsx)(h.Z,{className:"team-section",children:e&&e.length>0?e.map((e=>(0,ue.jsx)(ge.Z,{className:"team-card",children:(0,ue.jsxs)(fe.Z,{className:"d-flex justify-content-between align-items-center",children:[(0,ue.jsx)(xe,{tag:"h5",className:"team-title",children:e.name}),(0,ue.jsx)(s.rU,{"aria-label":"team-link-".concat(e.tid),to:"/teams/".concat(e.tid),children:(0,ue.jsx)(V.Z,{color:"primary",className:"open-btn",children:"Open"})})]})},e.id))):(0,ue.jsx)(be.Z,{color:"info",children:"No teams found."})})})})}function Te(){return(0,ue.jsx)(Ne,{})}function we(){return(0,ue.jsx)("div",{className:"m-3 justify-content-center",children:(0,ue.jsx)(be.Z,{color:"primary",timeout:0,children:"Kindly Signin or signup if you don't have an account."})})}function ke(){const{isAuthenticated:e}=(0,n.C)((e=>e.auth));return(0,ue.jsxs)("main",{className:"flex min-h-screen flex-col p-6",children:[(0,ue.jsx)(me,{}),e?(0,ue.jsx)(Te,{}):(0,ue.jsx)(we,{})]})}},4667:(e,t,r)=>{r.d(t,{E$:()=>s,LL:()=>a,yp:()=>i});const n=r(8880).g.injectEndpoints({endpoints:e=>({getTeamMembers:e.query({query:e=>{let{tid:t,userId:r,search:n}=e;const a=new URLSearchParams;return a.set("limit","50"),n&&a.set("search",n),r&&a.set("user_id",r),"/teams/".concat(t,"/members/?").concat(a.toString())}}),createTeamMember:e.mutation({query:e=>{let{user:t,teamTid:r,display_name:n,role:a}=e;return{url:"/teams/".concat(r,"/members/"),method:"POST",body:{user:t,role:a,display_name:n}}},invalidatesTags:["Team"]})})}),{useGetTeamMembersQuery:a,useLazyGetTeamMembersQuery:s,useCreateTeamMemberMutation:i}=n}}]);